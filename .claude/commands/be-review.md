# Design Review Prompt

> 설계 리뷰를 수행할 때 사용하는 command입니다.
> `/be-design` 또는 `/be-api` 출력 결과를 검토합니다.

---

## Input 필수 항목

### 1. 리뷰 대상
$ARGUMENTS

### 2. 설계 문서
(이전 `/be-design`, `/be-api` 출력 결과)

---

## Output: 리뷰 체크리스트

### 1. 보안 검토
- [ ] 인증(Authentication) 적용 여부
- [ ] 인가(Authorization) - 리소스 소유권 검증
- [ ] 입력 유효성 검증 (Bean Validation)
- [ ] Rate limiting 필요 여부
- [ ] 민감 데이터 로깅 금지

### 2. 멱등성 검토
- [ ] 중복 요청 처리 방안
- [ ] Idempotency key 필요 여부
- [ ] Unique constraint 활용

### 3. TTL/만료 검토
- [ ] 세션/토큰 만료 정책
- [ ] 요청 타임아웃 설정
- [ ] 스케줄러 정리 작업 필요 여부

### 4. 트랜잭션 검토
- [ ] 트랜잭션 경계 명확
- [ ] 롤백 조건 정의
- [ ] 데드락 가능성

### 5. 에러 처리 검토
- [ ] 일관된 에러 응답 포맷
- [ ] 적절한 HTTP 상태 코드
- [ ] 사용자 친화적 메시지

### 6. 성능 검토
- [ ] N+1 쿼리 방지
- [ ] 필요한 인덱스 정의
- [ ] 페이징 적용 (목록 API)

### 7. 동시성 검토
- [ ] Race condition 가능성
- [ ] 낙관적/비관적 락 필요 여부
- [ ] 분산 환경 고려

---

## 리뷰 결과 포맷

```markdown
## 리뷰 요약

### 통과 항목
- [x] 인증/인가 적절
- [x] 입력 검증 완료

### 개선 필요
- [ ] Rate limiting 추가 권장 (브루트포스 방지)
- [ ] 인덱스 추가 필요: wallet_id

### 위험 요소
- 동시 발급 요청 시 중복 스탬프 가능 → 유니크 제약 추가 필요
```

---

## 사용 예시

```
/be-review 스탬프 발급 설계

설계 문서:
(이전 /be-design 출력 결과 붙여넣기)
```

---

## 리뷰 우선순위

| 우선순위 | 항목 | 이유 |
|----------|------|------|
| 높음 | 보안, 트랜잭션 | 데이터 무결성 |
| 중간 | 멱등성, TTL | 사용자 경험 |
| 낮음 | 성능 | MVP 이후 최적화 |

---

## 다음 단계

리뷰 완료 후:
1. 개선 사항 반영
2. `/be-impl` → 구현
